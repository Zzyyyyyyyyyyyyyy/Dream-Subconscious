.chaos {
  position: relative;
  isolation: isolate;
  min-height: 100vh;
  padding: clamp(2rem, 5vw, 3.75rem);
  display: flex;
  flex-direction: column;
  gap: clamp(2.25rem, 5vw, 3.5rem);
  color: #f8f5ff;
  font-family: "Inter", "Helvetica Neue", Arial, sans-serif;
  overflow: hidden;
  background: radial-gradient(circle at 50% 0%, rgba(87, 59, 131, 0.22), transparent 45%),
    radial-gradient(circle at 20% 80%, rgba(62, 35, 94, 0.38), transparent 55%),
    linear-gradient(180deg, rgba(5, 3, 10, 0.92), rgba(12, 7, 24, 0.98));
}

.chaos::before {
  content: "";
  position: absolute;
  inset: -40vmax;
  background-image: radial-gradient(circle at center, rgba(252, 84, 178, 0.08) 0%, transparent 55%),
    radial-gradient(circle at 40% 60%, rgba(111, 78, 194, 0.1) 0%, transparent 65%),
    repeating-radial-gradient(circle at center, rgba(247, 245, 255, 0.015) 0 1px, transparent 1px 3px);
  opacity: 0.7;
  filter: blur(30px) saturate(1.15);
  z-index: -3;
  animation: chaos-swell 12s ease-in-out infinite;
}

.chaos::after {
  content: "";
  position: absolute;
  inset: -20%;
  z-index: -2;
  background: radial-gradient(circle at 50% 45%, rgba(210, 104, 255, 0.16), transparent 65%);
  mix-blend-mode: screen;
  opacity: 0.65;
  transform: scale(0.94);
  filter: blur(50px);
  animation: chaos-heartbeat 5.6s ease-in-out infinite;
}

.chaos__header {
  display: grid;
  gap: clamp(1.1rem, 2.5vw, 1.6rem);
  max-width: 780px;
  z-index: 2;
}

.chaos__meta {
  display: grid;
  gap: 0.5rem;
}

.chaos__tag {
  font-size: 0.75rem;
  letter-spacing: 0.35em;
  text-transform: uppercase;
  color: rgba(248, 245, 255, 0.55);
}

.chaos__title {
  margin: 0;
  font-size: clamp(2.4rem, 7vw, 3.75rem);
  font-weight: 600;
  letter-spacing: -0.02em;
}

.chaos__subtitle {
  margin: 0;
  font-size: clamp(1rem, 2.6vw, 1.25rem);
  line-height: 1.7;
  color: rgba(238, 233, 255, 0.85);
}

.chaos__controls {
  display: flex;
  flex-wrap: wrap;
  gap: 0.9rem;
  align-items: center;
}

.chaos__button {
  position: relative;
  padding: 0.85rem 1.8rem;
  border-radius: 999px;
  border: 1px solid rgba(255, 236, 255, 0.3);
  background: linear-gradient(135deg, rgba(102, 51, 153, 0.45), rgba(33, 20, 53, 0.9));
  color: #fefbff;
  text-transform: uppercase;
  font-size: 0.82rem;
  letter-spacing: 0.28em;
  font-weight: 600;
  cursor: pointer;
  transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
  box-shadow: 0 0 25px rgba(149, 87, 212, 0.28);
}

.chaos__button:hover,
.chaos__button:focus-visible {
  transform: translateY(-2px);
  border-color: rgba(255, 255, 255, 0.7);
  box-shadow: 0 0 45px rgba(209, 132, 255, 0.45);
  outline: none;
}

.chaos__hint {
  color: rgba(228, 219, 255, 0.65);
  font-size: 0.82rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
}

.chaos__stage {
  position: relative;
  flex: 1;
  min-height: clamp(360px, 60vh, 680px);
  border-radius: clamp(1.5rem, 3vw, 2.4rem);
  overflow: hidden;
  background: radial-gradient(circle at 50% 50%, rgba(20, 13, 32, 0.78), rgba(6, 4, 12, 0.92));
  box-shadow: 0 45px 120px rgba(25, 8, 44, 0.6);
  border: 1px solid rgba(129, 99, 180, 0.32);
}

.chaos__stage::before {
  content: "";
  position: absolute;
  inset: -10%;
  background: repeating-linear-gradient(
      45deg,
      rgba(255, 255, 255, 0.015) 0 4px,
      transparent 4px 8px
    ),
    repeating-linear-gradient(
      -45deg,
      rgba(255, 255, 255, 0.01) 0 2px,
      transparent 2px 6px
    );
  opacity: 0.2;
  mix-blend-mode: screen;
  animation: noise-shimmer 10s linear infinite;
  pointer-events: none;
}

.chaos__fragments {
  position: absolute;
  inset: 0;
  filter: drop-shadow(0 25px 45px rgba(8, 0, 24, 0.75));
}

.chaos__fragment {
  position: absolute;
  top: var(--y, 50%);
  left: var(--x, 50%);
  width: min(20vmin, 180px);
  aspect-ratio: 1;
  border-radius: 18% 32% 24% 28% / 30% 25% 35% 22%;
  background-image: var(--fragment-image);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  overflow: hidden;
  transform: translate(-50%, -50%);
  transition:
    top 1s cubic-bezier(0.22, 0.68, 0.25, 0.99),
    left 1s cubic-bezier(0.22, 0.68, 0.25, 0.99),
    transform 1.05s cubic-bezier(0.22, 0.68, 0.25, 0.99),
    filter 0.6s ease;
  animation: fragment-float var(--float-duration, 8s) ease-in-out infinite alternate;
  animation-delay: var(--float-delay, 0s);
  filter: saturate(1.05) brightness(0.95) contrast(1.08);
}

.chaos__fragment::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.15) 0%,
      rgba(110, 83, 182, 0.18) 30%,
      rgba(10, 6, 24, 0.75) 100%
    );
  mix-blend-mode: soft-light;
  opacity: 0.7;
}

.chaos__fragment:nth-child(odd) {
  border-radius: 26% 18% 36% 20% / 18% 32% 26% 34%;
}

.chaos__fragment:nth-child(3n) {
  mix-blend-mode: screen;
}

.chaos__overlay {
  position: absolute;
  inset: 0;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.25s ease;
  z-index: 3;
}

.chaos__overlay--fear {
  background: radial-gradient(circle at 30% 40%, rgba(255, 204, 255, 0.05), transparent 55%),
    radial-gradient(circle at 70% 50%, rgba(255, 171, 239, 0.08), transparent 60%),
    repeating-linear-gradient(
      120deg,
      rgba(255, 255, 255, 0.08) 0 1px,
      transparent 1px 14px
    ),
    repeating-radial-gradient(
      circle at center,
      rgba(255, 255, 255, 0.08) 0 0.5px,
      transparent 0.5px 4px
    );
  mix-blend-mode: screen;
  filter: contrast(1.2) brightness(1.1);
}

.chaos__overlay--noise {
  background: repeating-conic-gradient(
      from 0deg,
      rgba(255, 255, 255, 0.025) 0deg 3deg,
      transparent 3deg 6deg
    ),
    repeating-linear-gradient(
      90deg,
      rgba(255, 255, 255, 0.015) 0 1px,
      transparent 1px 2px
    );
  opacity: 0.2;
  mix-blend-mode: soft-light;
  z-index: 1;
}

.chaos__footer {
  z-index: 2;
  color: rgba(229, 219, 255, 0.55);
  font-size: 0.85rem;
  letter-spacing: 0.05em;
}

.chaos__note {
  margin: 0;
}

.chaos.is-chaos .chaos__fragment {
  animation: none;
  top: var(--grid-y, 50%);
  left: var(--grid-x, 50%);
  transform: translate(-50%, -50%) rotate(var(--grid-rotate, 0deg)) scale(var(--grid-scale, 1));
  filter: saturate(1.25) brightness(1.05) contrast(1.2);
}

.chaos.is-chaos .chaos__stage::before {
  opacity: 0.32;
  animation-duration: 6s;
}

.chaos.is-chaos .chaos__overlay--noise {
  opacity: 0.35;
}

.chaos.is-panic {
  animation: panic-tilt 0.22s linear infinite;
}

.chaos.is-panic::after {
  animation-duration: 2.4s;
  opacity: 0.95;
}

.chaos.is-panic .chaos__stage {
  animation: panic-shake 0.16s linear infinite;
  box-shadow: 0 55px 120px rgba(110, 6, 33, 0.5);
  border-color: rgba(255, 105, 180, 0.55);
}

.chaos.is-panic .chaos__overlay--noise {
  opacity: 0.55;
}

.chaos.is-fear .chaos__overlay--fear {
  opacity: 0.85;
}

.chaos.is-fear .chaos__stage::before {
  opacity: 0.4;
}

.chaos.is-fear .chaos__fragment::after {
  opacity: 0.95;
}

@keyframes chaos-swell {
  0%,
  100% {
    transform: scale(1.05) rotate(0.5deg);
  }
  45% {
    transform: scale(1.18) rotate(-1.5deg);
  }
  75% {
    transform: scale(1.12) rotate(1.1deg);
  }
}

@keyframes chaos-heartbeat {
  0%,
  100% {
    opacity: 0.5;
    transform: scale(0.94);
  }
  30% {
    opacity: 0.85;
    transform: scale(1.02);
  }
  60% {
    opacity: 0.65;
    transform: scale(0.98);
  }
}

@keyframes fragment-float {
  0% {
    transform: translate(-50%, -50%) translate3d(calc(var(--float-x, 24px) * -1), calc(var(--float-y, 18px) * -1), 0)
      rotate(calc(var(--rotate, 12deg) * -1)) scale(var(--scale, 1));
  }
  50% {
    transform: translate(-50%, -50%) translate3d(calc(var(--float-x, 24px) * 0.4), calc(var(--float-y, 18px) * -0.35), 0)
      rotate(calc(var(--rotate, 12deg) * 0.4)) scale(calc(var(--scale, 1) * 1.02));
  }
  100% {
    transform: translate(-50%, -50%) translate3d(var(--float-x, 24px), var(--float-y, 18px), 0)
      rotate(var(--rotate, 12deg)) scale(var(--scale, 1));
  }
}

@keyframes noise-shimmer {
  0% {
    transform: translate3d(0, 0, 0) rotate(0deg);
  }
  50% {
    transform: translate3d(2%, -2%, 0) rotate(1deg);
  }
  100% {
    transform: translate3d(0, 0, 0) rotate(0deg);
  }
}

@keyframes panic-tilt {
  0% {
    transform: translate3d(0, 0, 0) rotate(0deg);
  }
  50% {
    transform: translate3d(-2px, 3px, 0) rotate(-0.4deg);
  }
  100% {
    transform: translate3d(1px, -2px, 0) rotate(0.35deg);
  }
}

@keyframes panic-shake {
  0% {
    transform: translate3d(-3px, 1px, 0) rotate(-0.4deg);
  }
  50% {
    transform: translate3d(3px, -2px, 0) rotate(0.35deg);
  }
  100% {
    transform: translate3d(-2px, 3px, 0) rotate(-0.25deg);
  }
}

@media (max-width: 720px) {
  .chaos {
    padding: clamp(1.5rem, 8vw, 2.25rem);
  }

  .chaos__controls {
    flex-direction: column;
    align-items: flex-start;
  }

  .chaos__hint {
    font-size: 0.75rem;
  }

  .chaos__stage {
    min-height: clamp(360px, 65vh, 520px);
  }

  .chaos__fragment {
    width: min(28vmin, 160px);
  }
}
